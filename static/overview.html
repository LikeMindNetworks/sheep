<!doctype html>

<html>

<head>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/2.2.1/mustache.min.js">
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.16.0/lodash.min.js">
	</script>

	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

	<style type="text/css" media="screen">
		body {}

		.stage-container {
			margin: 10px;
		}
	</style>
</head>

<body>
	<div id="view" class=container></div>

	<div id="pipelineTemplate" style="display: none">
		{{#pipelines}}
			<h2 class="row">{{repo}} | {{name}}</h2>
			<div class="row">{{#stages}}{{> stage}}{{/stages}}</div>
		{{/pipelines}}
	</div>

	<div id="stageTemplate" style="display: none">
		<div class="well col-sm-3 stage-container">
			<h4>{{name}}</h4>
		</div>
	</div>

	<script>
window._data = [
  {
    "name": "sheep",
    "repo": "sencenan/sheep",
    "stages": [
      {
        "name": "alpha",
        "state": "UNBLOCKED",
        "lastFive": [
          {
            "commit": "c8da44241b613ada724c4667772d510a53ab70b6",
            "commitMessage": "m: render overview",
            "commitTimestamp": 1474326420000,
            "author": {
              "name": "sen.cenan@gmail.com",
              "email": "sen.cenan@gmail.com",
              "username": "sencenan"
            },
            "status": {
              "status": "SUCCEED"
            }
          },
          {
            "commit": "04891f9ed069ef0d30ffc7c988fcc044a64882ec",
            "commitMessage": "m: missed require",
            "commitTimestamp": 1474324302000,
            "author": {},
            "status": {
              "status": "SUCCEED"
            }
          },
          {
            "commit": "14f4682807efc3be42d802e0830d34a34a1d186f",
            "commitMessage": "m: missed upload reports",
            "commitTimestamp": 1474323953000,
            "author": {},
            "status": {
              "status": "SUCCEED"
            }
          },
          {
            "commit": "128fc63a20ca12245529001084ad6ed91c6ffb80",
            "commitMessage": "m: remove file based update of status",
            "commitTimestamp": 1474323288000,
            "author": {},
            "status": {
              "status": "SUCCEED"
            }
          },
          {
            "commit": "6c6097e57450d89624a865c80bed075bf1ccc9c2",
            "commitMessage": "m: missing paramters",
            "commitTimestamp": 1474322950000,
            "author": {},
            "status": {
              "status": "SUCCEED"
            }
          }
        ]
      },
      {
        "name": "beta",
        "state": "UNBLOCKED",
        "lastFive": [
          {
            "commit": "c8da44241b613ada724c4667772d510a53ab70b6",
            "commitMessage": "m: render overview",
            "commitTimestamp": 1474326420000,
            "author": {
              "name": "sen.cenan@gmail.com",
              "email": "sen.cenan@gmail.com",
              "username": "sencenan"
            },
            "status": {
              "status": "SUCCEED"
            }
          },
          {
            "commit": "04891f9ed069ef0d30ffc7c988fcc044a64882ec",
            "commitMessage": "m: missed require",
            "commitTimestamp": 1474324302000,
            "author": {},
            "status": {
              "status": "SUCCEED"
            }
          },
          {
            "commit": "128fc63a20ca12245529001084ad6ed91c6ffb80",
            "commitMessage": "m: remove file based update of status",
            "commitTimestamp": 1474323288000,
            "author": {},
            "status": {
              "status": "SUCCEED"
            }
          },
          {
            "commit": "6c6097e57450d89624a865c80bed075bf1ccc9c2",
            "commitMessage": "m: missing paramters",
            "commitTimestamp": 1474322950000,
            "author": {},
            "status": {
              "status": "SUCCEED"
            }
          },
          {
            "commit": "51e92b7cbe561f5b577e424f14d421909c046e22",
            "commitMessage": "",
            "commitTimestamp": 1473909624000,
            "author": {},
            "status": {
              "status": "SUCCEED"
            }
          }
        ]
      }
    ]
  }
];
	</script>

	<script>
var getTemplate = function(template) {
	return _.unescape(document.getElementById(template).innerHTML).trim();
};

var
	pipelineTemplate = getTemplate('pipelineTemplate'),
	stageTemplate = getTemplate('stageTemplate');

var html = Mustache.render(
	pipelineTemplate,
	{ pipelines: _data },
	{
		stage: stageTemplate
	}
);

document.getElementById('view').innerHTML = html;
	</script>
</body>

</html>
